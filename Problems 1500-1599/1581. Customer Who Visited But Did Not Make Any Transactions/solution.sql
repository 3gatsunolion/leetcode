SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS
FROM VISITS
LEFT JOIN
TRANSACTIONS
ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID
WHERE TRANSACTION_ID IS NULL
GROUP BY CUSTOMER_ID;